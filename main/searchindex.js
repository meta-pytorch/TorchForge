Search.setIndex({"docnames": ["api", "api_actors", "api_generator", "api_model", "api_service", "api_trainer", "getting_started", "index", "metric_logging", "tutorials", "tutorials/zero-to-forge/1_RL_and_Forge_Fundamentals", "tutorials/zero-to-forge/2_Forge_Internals", "tutorials/zero-to-forge/3_Monarch_101", "zero-to-forge-intro"], "filenames": ["api.md", "api_actors.md", "api_generator.md", "api_model.md", "api_service.md", "api_trainer.md", "getting_started.md", "index.md", "metric_logging.md", "tutorials.md", "tutorials/zero-to-forge/1_RL_and_Forge_Fundamentals.md", "tutorials/zero-to-forge/2_Forge_Internals.md", "tutorials/zero-to-forge/3_Monarch_101.md", "zero-to-forge-intro.md"], "titles": ["API Reference", "ForgeActor", "Generator", "Model", "Service", "Trainer", "Getting Started", "TorchForge Documentation", "Metric Logging in Forge", "Tutorials", "Part 1: RL Fundamentals - Using TorchForge Terminology", "Part 2: Peeling Back the Abstraction - What Are Services?", "Part 3: The TorchForge-Monarch Connection", "Zero to TorchForge: From RL Theory to Production-Scale Implementation"], "terms": {"thi": [0, 1, 2, 3, 4, 5, 6, 8, 9, 11, 13], "section": [0, 6, 8, 9, 10, 11, 12, 13], "provid": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11], "comprehens": [0, 4, 13], "document": [0, 3, 5, 6], "torchforg": [0, 1, 2, 5, 6, 9], "i": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13], "pytorch": [0, 5, 6, 7, 12, 13], "nativ": [0, 7], "platform": [0, 7], "post": [0, 7], "train": [0, 1, 3, 7, 9, 10], "gener": [0, 1, 5, 7, 8, 10, 11], "ai": [0, 6, 7, 10], "model": [0, 1, 2, 6, 7, 8, 9, 10, 11, 12, 13], "design": [0, 2], "streamlin": 0, "reinforc": [0, 1, 2, 3, 5, 6, 7, 13], "learn": [0, 1, 2, 3, 5, 6, 7, 11, 13], "workflow": [0, 1, 2, 5, 7], "larg": [0, 7, 10], "languag": [0, 13], "The": [0, 1, 2, 3, 4, 5, 6, 8, 13], "leverag": [0, 7, 8], "": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "distribut": [0, 1, 3, 5, 6, 7, 8, 9, 10, 11, 13], "comput": [0, 3, 5, 10, 11], "capabl": [0, 7, 9], "built": [0, 1, 2, 5, 6, 7, 11, 12], "top": [0, 2, 5, 12], "monarch": [0, 2, 6, 7, 8, 11, 13], "make": [0, 2, 6, 7, 8], "extens": [0, 7], "us": [0, 1, 2, 3, 4, 5, 6, 7, 11, 13], "actor": [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 11], "fault": [0, 5, 7, 11], "toler": [0, 5, 7, 11], "kei": [0, 4, 5, 6, 7, 8, 10, 11], "featur": [0, 5, 6, 7], "includ": [0, 4, 5, 6, 7], "base": [0, 1, 2, 3, 5, 7, 10, 11], "architectur": [0, 3], "an": [0, 1, 4, 5, 8, 10, 11, 13], "system": [0, 1, 3, 5, 7, 10, 11, 12, 13], "excel": 0, "scalabl": 0, "ensur": [0, 5, 6, 7, 8, 11], "seamless": 0, "integr": [0, 7], "exist": [0, 5, 7], "focu": [0, 7, 10], "specif": [0, 4, 5, 6, 7, 11, 12], "techniqu": [0, 7], "like": [0, 1, 5, 6, 7, 8, 10, 11, 12], "rlvr": [0, 7], "sft": [0, 7, 13], "other": [0, 1, 2, 3, 5, 10, 11], "align": [0, 7], "method": [0, 1, 3, 4, 5, 8, 11, 12], "support": [0, 5, 6, 7, 8], "multi": [0, 6, 7, 11], "gpu": [0, 1, 4, 5, 6, 7, 8, 10, 11, 12], "node": 0, "out": [0, 7], "box": 0, "For": [0, 3, 5, 6, 7, 8, 11], "most": [0, 5, 11], "case": [0, 5], "you": [0, 1, 5, 6, 8, 9, 10, 11, 13], "ll": [0, 10], "interact": [0, 7, 10], "high": [0, 7, 10, 11], "level": [0, 8, 10, 12], "servic": [0, 1, 13], "interfac": [0, 10], "which": [0, 4, 5, 8, 12], "handl": [0, 4, 5, 6, 7, 10, 12], "complex": [0, 1, 7, 11, 12], "coordin": [0, 6, 7], "automat": [0, 1, 4, 5, 7, 8, 11, 12], "advanc": [0, 9], "user": [0, 5, 8], "who": 0, "need": [0, 1, 4, 5, 8, 11], "fine": [0, 7, 9], "grain": 0, "control": [0, 1, 2, 4, 5, 7, 8, 11], "individu": [0, 12], "direct": 0, "access": [0, 6, 8], "underli": [0, 12], "compon": [0, 1, 5, 6, 7], "forgeactor": [0, 2, 3, 8, 11, 12], "trainer": [0, 6, 10, 11], "modul": [1, 5, 7], "contain": [1, 5], "core": [1, 2, 6, 12], "infer": [1, 2, 3, 5, 6, 7, 10, 11], "These": [1, 8, 11], "pre": [1, 5, 6, 7], "essenti": [1, 7, 11], "function": [1, 4, 5, 6, 8, 11, 12], "can": [1, 5, 6, 8, 10, 11, 12, 13], "build": [1, 6, 11, 13], "block": [1, 7, 8, 11], "class": [1, 2, 3, 4, 5, 8, 11, 12], "forg": [1, 2, 3, 4, 5, 6, 7, 9, 10, 11], "arg": [1, 4, 8], "kwarg": [1, 4, 8], "sourc": [1, 2, 3, 4, 5, 11, 12], "configur": [1, 3, 4, 7], "resourc": [1, 4, 7, 11, 12], "attribut": 1, "initi": [1, 5, 8, 11, 12], "set": [1, 3, 5, 6, 8], "up": [1, 4, 5], "log": [1, 3, 4, 7, 9], "rank": [1, 5, 8], "size": [1, 3, 5, 6, 10], "inform": [1, 4], "process": [1, 5, 6, 8, 10, 11], "mesh": [1, 2, 7, 8], "refer": [1, 3, 5, 6, 7, 10, 13], "ar": [1, 2, 4, 5, 6, 8, 10, 12, 13], "determin": [1, 11], "from": [1, 3, 4, 5, 6, 7, 9, 11, 12], "current": [1, 5, 6, 7, 11, 13], "execut": [1, 2, 7], "context": [1, 5, 8, 11], "paramet": [1, 2, 4, 5, 6, 11, 12], "variabl": [1, 3], "length": [1, 5], "argument": [1, 2, 4, 5, 12], "list": [1, 4, 5, 8, 10, 11], "pass": [1, 3, 4, 5, 8, 12], "parent": 1, "arbitrari": 1, "keyword": [1, 4], "async": [1, 2, 4, 5, 7, 8, 10, 11, 12], "classmethod": [1, 2, 8], "as_actor": [1, 10, 11, 12], "actor_kwarg": [1, 4], "spawn": [1, 6, 8, 11, 12], "singl": [1, 5, 7, 8, 10], "store": [1, 5, 7, 8, 10, 11], "option": [1, 2, 3, 5, 8, 10, 11, 12], "default": [1, 2, 5, 11], "valu": [1, 5, 7, 8, 11, 12], "subclass": 1, "return": [1, 2, 3, 4, 5, 8, 10, 11, 12], "proc": [1, 2, 6, 8, 10, 11, 12], "construct": 1, "processconfig": 1, "instanc": [1, 2, 5, 8, 10, 11, 12], "If": [1, 2, 4, 5, 6, 10, 13], "wa": 1, "type": [1, 2, 4, 5, 10], "typevar": 1, "t": [1, 5, 6, 8, 11, 12], "bound": [1, 11], "host": [1, 11], "none": [1, 2, 5, 8, 10, 11, 12], "number": [1, 4, 5, 8, 11, 12], "across": [1, 5, 6, 7, 8, 11, 12], "mani": [1, 5, 11, 12], "accommod": 1, "request": [1, 4, 7, 10, 11], "launch": 1, "provis": 1, "deploi": 1, "new": [1, 4, 5, 6, 11], "replica": [1, 4, 5, 8, 10, 12], "we": [1, 5, 8, 10, 11, 12], "implement": [1, 4, 5, 7, 8, 9, 10], "wai": [1, 5, 11], "becaus": [1, 5], "special": [1, 7], "server": 1, "mai": [1, 5, 8, 10], "compos": [1, 7], "multipl": [1, 5, 10, 11], "allow": [1, 5, 8], "specifi": [1, 5], "how": [1, 5, 8, 10, 13], "your": [1, 7, 10, 11], "get": [1, 2, 4, 5, 7, 10, 11, 12], "togeth": [1, 10], "basic": [1, 6, 9, 11, 12], "assum": [1, 11], "re": [1, 13], "homogen": 1, "actormesh": [1, 11, 12], "mesh_nam": 1, "name": [1, 4, 5, 6, 11], "num_replica": [1, 2, 8, 10, 11], "1": [1, 2, 5, 7, 12, 13], "creat": [1, 5, 6, 10, 11, 12], "when": [1, 4, 5, 6, 8, 10, 11, 12], "onli": [1, 3, 5, 12], "appli": [1, 5], "as_servic": [1, 2, 8, 10, 11, 12], "with_gpu": [1, 2, 8, 10, 11], "fals": [1, 5, 8, 10, 11], "version": [1, 6, 11], "befor": [1, 6, 7, 8, 11], "each": [1, 4, 5, 8, 10, 11, 12, 13], "call": [1, 2, 4, 5, 10, 11], "separ": [1, 5, 12], "so": [1, 5, 8], "differ": [1, 2, 5, 11, 12], "coexist": 1, "without": [1, 3, 5, 7, 8, 11, 12], "interf": 1, "exampl": [1, 2, 4, 5, 7, 8, 12, 13], "rtype": 1, "await": [1, 2, 4, 7, 8, 10, 11, 12], "myforgeactor": 1, "2": [1, 5, 12, 13], "shutdown": [1, 2, 8, 11], "usag": [1, 5, 8, 10, 11, 12], "shut": [1, 11], "down": [1, 11], "teardown": 1, "whether": [1, 2, 5, 12], "alloc": [1, 11], "polici": [2, 3, 5, 6, 7, 10, 11, 12], "engin": [2, 3, 5, 7, 13], "vllm": [2, 6, 7], "It": [2, 3, 5, 13], "manag": [2, 4, 5, 6, 7, 8, 12], "serv": [2, 3, 8, 12], "text": [2, 7, 10, 11], "weight": [2, 5, 6, 7, 8, 10], "updat": [2, 4, 5, 10, 11], "engine_arg": 2, "factori": [2, 3, 5], "sampling_param": 2, "use_dcp_for_weight_sync": 2, "prefetch_weights_to_shm": 2, "true": [2, 5, 8, 10, 11], "n_fetcher_proc": 2, "8": [2, 5, 6, 10, 11, 12], "manual": [2, 11], "recreat": 2, "mirror": 2, "asyncllmengin": 2, "v1": 2, "main": [2, 6, 8, 10, 11], "all": [2, 4, 5, 6, 7, 8, 10, 11, 12], "commun": [2, 3, 5, 10, 12], "here": [2, 5, 6, 8, 10, 11], "via": [2, 5], "enginearg": 2, "samplingparam": 2, "sampl": [2, 7, 10, 11], "bool": 2, "dcp": [2, 5], "nf": 2, "sync": [2, 6, 8], "depend": [2, 6, 7], "rdma": [2, 7], "enabl": [2, 3, 4, 5, 6], "torchstor": [2, 6, 7, 11], "disabl": [2, 4, 5, 8], "otherwis": [2, 5, 11], "tell": 2, "me": 2, "joke": 2, "complet": [2, 4, 5, 7, 10, 11], "prompt": [2, 7, 10, 11], "A": [2, 3, 5, 11, 13], "why": 2, "did": [2, 10], "chicken": 2, "cross": [2, 12], "road": 2, "b": 2, "To": [2, 5, 8], "side": 2, "token_id": [2, 7, 10, 11], "logprob": [2, 10], "get_vers": [2, 11], "get_vllm_config": 2, "register_work": 2, "run": [2, 3, 5, 6, 7, 8, 11], "schedul": [2, 5], "output": [2, 5, 6, 8, 11, 12], "project": [2, 7], "setup": [2, 3, 5, 7, 8], "stop": [2, 4, 8, 10, 12], "update_weight": [2, 10, 11], "vllm_config": 2, "gpuwork": 2, "In": [2, 5, 8, 10, 11, 12], "should": [2, 4, 5, 7], "instanti": [2, 4], "directli": [2, 6, 10, 12], "rather": [2, 6], "creation": 2, "invoc": 2, "execute_model": 2, "setup_kv_cach": 2, "reference_model": [3, 10, 11], "frozen": [3, 6], "copi": [3, 5, 10], "advantag": [3, 10, 11], "perform": [3, 4, 5, 7, 11, 12], "input": [3, 5, 10, 11], "sequenc": [3, 5], "logit": [3, 5], "probabl": 3, "kl": [3, 5], "diverg": [3, 5], "rl": [3, 9, 11, 12], "metric": [3, 4, 7, 9], "parallel": [3, 6, 7, 10, 11], "checkpoint": [3, 6, 11], "compil": [3, 5], "comm": [3, 5], "torchtitan": [3, 5, 6, 7], "forward": [3, 5, 10, 11], "gradient": [3, 5], "typic": [3, 5, 6, 11], "maintain": [3, 4, 7, 11, 12], "algorithm": [3, 5, 7, 10], "consist": [3, 4], "optim": [3, 7, 10, 11, 12], "grpo": [3, 5, 7, 10, 11], "group": [3, 5, 7, 11], "rel": [3, 5, 7], "ppo": [3, 7], "proxim": 3, "where": [3, 5, 6, 10, 11, 12], "fix": 3, "point": [3, 5, 12], "penalti": [3, 5], "against": [3, 5], "load": [3, 4, 5, 10], "evalu": [3, 10, 11], "mode": [3, 5, 10], "inference_mod": 3, "memori": [3, 5, 7, 10, 12], "effici": [3, 7, 11], "vocab": 3, "etc": [3, 5, 6, 11, 12], "collect": [3, 5, 8, 10, 12], "strategi": [3, 5, 6, 10], "dp": [3, 5], "tp": [3, 5], "pp": [3, 5], "cp": [3, 5], "torch": [3, 5, 6, 8, 10, 11], "backend": 3, "relat": 3, "dtype": [3, 5, 10], "garbag": [3, 5, 11], "subset": 3, "dataclass": [3, 5], "detail": [3, 4, 6, 8, 10, 13], "cfg": 4, "actor_def": 4, "actor_arg": 4, "less": 4, "temporari": [4, 5], "solut": [4, 11], "nest": 4, "prove": 4, "problemat": 4, "temporarili": 4, "per": [4, 5, 8, 11, 12], "health": [4, 11], "poll": 4, "rate": [4, 5, 6], "definit": [4, 5, 11], "posit": 4, "constructor": [4, 12], "member": 4, "call_al": 4, "start_sess": 4, "get_metr": 4, "get_metrics_summari": 4, "terminate_sess": 4, "show": [4, 12], "inherit": 4, "broadcast": [4, 12], "healthi": [4, 10, 11], "result": [4, 5, 8, 12], "endpoint": [4, 8, 11, 12], "rais": 4, "runtimeerror": 4, "avail": [4, 5, 6, 11], "monitor": [4, 11], "analysi": 4, "data": [4, 5, 6, 7, 8, 10, 11], "wide": 4, "aggreg": [4, 8], "statu": [4, 7], "servicemetr": 4, "object": [4, 7, 8, 11], "print": [4, 5, 6, 8, 11, 12], "f": [4, 6, 10, 11, 12], "get_total_request_r": 4, "1f": 4, "req": 4, "queue": 4, "depth": 4, "get_avg_queue_depth": 4, "summari": [4, 8, 11], "debug": [4, 5, 8, 12], "structur": [4, 10, 11, 12], "format": [4, 5], "suitabl": 4, "dashboard": 4, "purpos": [4, 5, 12], "dict": [4, 5, 8], "healthy_replica": 4, "idx": 4, "item": [4, 8], "request_r": 4, "start": [4, 5, 7, 8, 10], "session": [4, 12], "state": [4, 5, 8, 12], "affin": 4, "workload": 4, "requir": [4, 5, 8, 10, 11], "uniqu": 4, "id": 4, "assign": [4, 12], "least": [4, 10], "str": [4, 6, 8, 11], "identifi": 4, "subsequ": 4, "session_id": 4, "my_endpoint": 4, "arg1": 4, "arg2": 4, "longer": [4, 6], "sess_id": 4, "termin": [4, 5], "activ": [4, 5, 6], "clean": 4, "associ": 4, "remov": [4, 6, 11], "track": 4, "clear": [4, 11], "free": [4, 6], "backward": [5, 8], "lr_schedul": 5, "activation_checkpoint": 5, "quantiz": 5, "memory_estim": 5, "loss": [5, 8, 10, 11], "lambda": 5, "state_dict_kei": 5, "model_state_dict": 5, "use_dcp": 5, "dcp_path": 5, "forge_dcp_tmp": 5, "loop": [5, 10], "step": [5, 7, 8, 9, 11, 12], "unlik": [5, 10], "referencemodel": [5, 10, 11], "through": [5, 6, 11], "descent": 5, "same": [5, 8, 10, 11, 12], "doe": [5, 10], "limit": [5, 11], "tensor": [5, 6, 7, 10, 11], "fsdp": [5, 6, 7], "fulli": [5, 7], "shard": [5, 6, 10], "conjunct": 5, "propag": 5, "mix": [5, 7, 10], "precis": [5, 6, 8], "amp": 5, "cleanup": [5, 11, 12], "forward_backward": 5, "target": [5, 7, 10, 11], "push_weight": [5, 10, 11], "train_step": [5, 8, 10, 11], "follow": [5, 6, 7, 8], "config": [5, 6, 10, 11], "job_config": 5, "config_fil": 5, "dump_fold": 5, "descript": 5, "print_config": 5, "custom_config_modul": 5, "file": [5, 7, 8], "extend": [5, 8], "jobconfig": 5, "custom": [5, 7, 8], "path": [5, 6, 10, 11], "import": [5, 6, 8, 10, 11, 12], "folder": 5, "dump": 5, "llama3": [5, 7], "flavor": [5, 10, 11], "debugmodel": 5, "hf_assets_path": [5, 10, 11], "test": [5, 6, 7], "asset": 5, "token": [5, 10, 11], "tokenizer_path": 5, "convert": 5, "print_after_convers": 5, "comma": 5, "float8": 5, "swap": 5, "nn": 5, "linear": 5, "float8linear": 5, "instal": [5, 7], "torchao": 5, "found": 5, "ao": 5, "hf": [5, 6, 10, 11], "local": [5, 6, 8, 12], "hug": [5, 6], "face": [5, 6], "safetensor": 5, "index": [5, 7], "json": 5, "fqn": 5, "map": [5, 10, 12], "generation_config": 5, "stdout": 5, "after": [5, 6, 8], "have": [5, 6, 8, 11, 12], "been": [5, 7], "instead": [5, 6, 8, 11, 12], "deprec": 5, "adamw": [5, 10, 11], "lr": [5, 10, 11], "0": [5, 6, 8, 10, 11, 12], "0008": 5, "beta1": 5, "9": 5, "beta2": 5, "95": [5, 10], "ep": 5, "1e": [5, 6, 10, 11], "08": 5, "weight_decai": 5, "fuse": 5, "early_step_in_backward": 5, "exponenti": 5, "move": 5, "averag": [5, 8, 11], "hyperparamet": [5, 6], "caution": 5, "optimizer_in_backward": 5, "compat": 5, "clip": 5, "register_post_accumulate_grad_hook": 5, "epsilon": 5, "cuda": [5, 6, 8], "best": 5, "foreach": 5, "some": [5, 6, 10, 11, 13], "horizont": 5, "fusion": 5, "better": [5, 10], "slowest": [5, 11], "more": [5, 6, 11, 13], "info": [5, 8], "http": [5, 6, 7], "org": [5, 6, 7], "doc": [5, 6, 7, 13], "stabl": 5, "html": 5, "decai": 5, "dataset": [5, 6, 10], "c4_test": 5, "dataset_path": 5, "local_batch_s": [5, 10, 11], "global_batch_s": 5, "seq_len": [5, 10, 11], "2048": [5, 10, 11], "max_norm": 5, "10000": 5, "enable_cpu_offload": 5, "float32": 5, "mixed_precision_param": 5, "bfloat16": [5, 10], "mixed_precision_reduc": 5, "gc_freq": 5, "50": 5, "gc_debug": 5, "seed": 5, "determinist": 5, "debug_moe_force_load_bal": 5, "download": [5, 6], "forc": 5, "expert": 5, "amount": 5, "round": [5, 11], "robin": [5, 11], "wherev": 5, "possibl": 5, "slower": 5, "contrast": 5, "training_dtyp": 5, "put": 5, "extra": 5, "fp32": 5, "full": [5, 6, 10, 11], "bf16": [5, 6], "rope": 5, "calcul": 5, "still": 5, "cpu": [5, 8, 10, 11, 12], "offload": 5, "gc": 5, "everi": 5, "detect": 5, "cycl": 5, "note": [5, 6, 10, 11, 12], "want": [5, 11], "lower": 5, "avoid": [5, 6, 11], "too": [5, 11, 13], "python": [5, 6, 7, 11], "interv": 5, "global": [5, 8], "batch": [5, 6, 7, 10, 11], "degre": [5, 7], "e": [5, 6, 8], "devic": [5, 8], "max": [5, 8], "norm": 5, "fully_shard": 5, "autocast": 5, "take": 5, "effect": [5, 11, 12], "data_parallel_shard_degre": 5, "context_parallel_degre": 5, "data_replicate_degre": 5, "under": [5, 11], "ddp": 5, "reduct": [5, 8], "choos": [5, 7, 11, 12], "rng": 5, "data_parallel_replicate_degre": 5, "enable_compiled_autograd": 5, "fsdp_reshard_after_forward": 5, "tensor_parallel_degre": 5, "disable_loss_parallel": 5, "enable_async_tensor_parallel": 5, "pipeline_parallel_degre": 5, "module_fqns_per_model_part": 5, "pipeline_parallel_first_stage_less_lay": 5, "pipeline_parallel_last_stage_less_lay": 5, "pipeline_parallel_layers_per_stag": 5, "pipeline_parallel_schedul": 5, "1f1b": 5, "pipeline_parallel_schedule_csv": 5, "pipeline_parallel_microbatch_s": 5, "context_parallel_rotate_method": 5, "allgath": 5, "expert_parallel_degre": 5, "expert_tensor_parallel_degre": 5, "mean": [5, 8, 12], "sdpa": 5, "kv": 5, "exchang": 5, "gather": [5, 10, 11], "first": [5, 6, 7, 8, 11], "sub": 5, "alltoal": 5, "shuffl": 5, "replic": [5, 10], "greater": 5, "than": [5, 6, 11], "also": [5, 8], "hsdp": 5, "hybrid": 5, "leftov": 5, "dp_replic": 5, "sp": 5, "neg": 5, "compiledautograd": 5, "No": [5, 7, 8, 10, 12], "non": [5, 7, 8, 11], "moe": 5, "constraint": 5, "etp": 5, "dp_shard": 5, "experiment": [5, 7], "relax": 5, "soon": [5, 11, 13], "flexibl": 5, "devicemesh": 5, "With": [5, 7], "rout": [5, 7, 10, 12], "param": 5, "either": [5, 6], "partial": 5, "reshard_after_forward": 5, "within": [5, 8, 11], "behavior": [5, 6], "trade": 5, "off": [5, 7], "see": [5, 8, 10, 11], "api": [5, 6, 7, 10, 11, 12, 13], "alwai": [5, 12], "never": 5, "reshard": [5, 7], "smart": 5, "known": 5, "scenario": [5, 9], "qualifi": 5, "chunk": 5, "inner": 5, "repres": 5, "one": [5, 8, 11, 12], "belong": 5, "g": [5, 8], "tok_embed": 5, "layer": [5, 10, 12, 13], "3": [5, 6, 7, 13], "4": [5, 6, 10, 11, 12], "second": 5, "third": 5, "explicit": 5, "over": 5, "compar": [5, 10], "split": 5, "pipelin": [5, 7, 10], "physic": 5, "stage": 5, "reduc": 5, "ha": [5, 7, 8, 10, 11], "overhead": [5, 8], "embed": 5, "present": 5, "last": 5, "virtual": 5, "microbatch": 5, "total": [5, 8, 11], "divid": 5, "must": [5, 8], "evenli": 5, "divis": 5, "stages_per_rank": 5, "interleaved1f1b": 5, "split_point": 5, "csv": 5, "pipelineschedulesingl": 5, "pipelineschedulemulti": 5, "_pipelinescheduleruntim": 5, "enable_ft_dataloader_checkpoint": 5, "500": 5, "initial_load_path": 5, "initial_load_model_onli": 5, "initial_load_in_hf": 5, "initial_load_in_hf_quant": 5, "last_save_model_onli": 5, "last_save_in_hf": 5, "export_dtyp": 5, "async_mod": 5, "keep_latest_k": 5, "10": [5, 6, 8, 11], "load_step": 5, "exclude_from_load": 5, "enable_first_step_checkpoint": 5, "create_seed_checkpoint": 5, "load_onli": 5, "synchron": [5, 6, 7, 10], "async_sav": 5, "async_with_pinned_mem": 5, "util": [5, 8, 10], "dedic": 5, "pin": 5, "space": [5, 6], "faster": [5, 6, 11], "transfer": [5, 7], "elimin": [5, 7, 8, 11], "gil": 5, "content": 5, "cost": 5, "increas": [5, 11], "insuffici": 5, "degrad": [5, 10], "due": 5, "page": 5, "suffic": 5, "small": [5, 10], "order": 5, "ten": 5, "frequenc": [5, 11], "emploi": 5, "pursu": 5, "zero": [5, 7, 9], "time": [5, 7, 10], "given": 5, "appropri": 5, "hardwar": [5, 12], "ampl": 5, "fast": [5, 6, 11], "pcie": 5, "save": [5, 6, 8], "py": [5, 6, 8, 10, 11], "ani": [5, 7, 8, 10, 11], "ngpu": 5, "could": 5, "script": [5, 6], "share": [5, 11], "code": [5, 6, 10, 11], "immedi": [5, 11], "correctli": [5, 6], "cluster": [5, 7, 12], "storag": [5, 10, 11], "verifi": [5, 7, 10, 11, 12], "wait": [5, 10, 11], "frequent": 5, "accept": 5, "dataload": [5, 7, 10, 11], "torchft": 5, "loader": 5, "resum": 5, "go": [5, 10, 11], "twice": 5, "overfit": 5, "fail": [5, 11, 12], "replcia": 5, "recov": [5, 12], "regular": [5, 11], "But": [5, 7, 11], "entir": [5, 10, 13], "scratch": 5, "warn": 5, "exclud": [5, 6], "being": [5, 6, 10, 11], "huggingfac": [5, 6], "necessari": 5, "transform": 5, "doesn": [5, 11], "initial_load_path_in_hf": 5, "dequant": 5, "defin": [5, 8, 12], "proper": 5, "huggingfacestorageread": 5, "dure": 5, "treat": [5, 10], "standard": 5, "no_initial_load_model_onli": 5, "overrid": 5, "particularli": 5, "previou": [5, 8, 11, 12], "empti": 5, "locat": [5, 12], "ignor": 5, "continu": [5, 7, 10, 11, 12], "affect": 5, "ones": 5, "pre_train": 5, "llama3_8b": [5, 6], "step_10000": 5, "keep": [5, 10], "latest": [5, 6, 12], "k": 5, "purg": 5, "older": 5, "cannot": 5, "As": 5, "metadata": 5, "readi": [5, 11], "yet": [5, 11], "fill": 5, "disk": [5, 6], "final": [5, 8, 11], "There": 5, "consolid": [5, 6], "On": 5, "isn": 5, "end": [5, 11], "weights_onli": 5, "convers": [5, 11], "train_stat": 5, "certain": 5, "verif": [5, 7], "might": [5, 11], "valid": 5, "correct": [5, 11], "guid": [6, 7, 9, 12, 13], "walk": 6, "its": [6, 8, 12], "job": 6, "meet": [6, 7], "oper": 6, "linux": 6, "fedora": 6, "ubuntu": 6, "debian": 6, "maco": 6, "window": 6, "higher": [6, 11], "11": [6, 12], "recommend": [6, 11], "nvidia": 6, "amd": 6, "minimum": [6, 7], "larger": 6, "12": [6, 8], "ram": 6, "32gb": 6, "50gb": 6, "nightli": [6, 7], "dtensor": [6, 7], "packag": 6, "wheel": 6, "orchestr": [6, 7], "v0": 6, "pagedattent": [6, 7], "product": [6, 7, 9, 11], "infrastructur": [6, 7], "conda": 6, "miniconda": 6, "environ": [6, 7, 10], "io": 6, "github": [6, 7], "cli": 6, "gh": 6, "instruct": [6, 7], "com": [6, 7], "authent": 6, "auth": 6, "login": 6, "ssh": 6, "protocol": 6, "git": 6, "clone": 6, "repositori": 6, "usual": [6, 11], "alreadi": [6, 11], "reliabl": 6, "meta": [6, 7], "cd": 6, "n": [6, 8, 10, 11], "sh": 6, "dnf": 6, "sudo": 6, "prefer": [6, 7], "ad": 6, "pyproject": 6, "toml": 6, "uv": 6, "inexact": 6, "work": [6, 7, 8, 10, 12], "check": [6, 7, 8, 11, 12], "c": 6, "device_count": 6, "expect": [6, 7], "success": 6, "__version__": 6, "this_host": [6, 12], "spawn_proc": [6, 12], "now": [6, 8, 10, 11, 12], "let": [6, 7, 8, 10, 12], "what": [6, 8, 13], "look": [6, 7, 10, 11, 12], "llama": 6, "8b": [6, 7], "dir": 6, "tmp": 6, "origin": [6, 10], "00": 6, "pth": 6, "nproc_per_nod": 6, "app": [6, 10, 11, 12], "yaml": [6, 10], "m": 6, "qwen3_1_7b": 6, "haven": 6, "happen": [6, 11], "power": [6, 7, 11, 12], "baselin": [6, 10], "score": [6, 7, 10, 11], "three": [6, 8], "examin": 6, "batch_siz": [6, 10, 11], "learning_r": 6, "5": [6, 10, 11, 12], "num_epoch": 6, "gradient_accumulation_step": 6, "save_interv": 6, "1000": [6, 8], "output_dir": 6, "explor": 6, "directori": 6, "read": [6, 11], "tutori": [6, 7], "encount": 6, "issu": [6, 7, 12], "search": 6, "bug": [6, 7], "report": [6, 7], "diagnost": 6, "command": 6, "below": [6, 10, 13], "error": 6, "messag": [6, 11, 12], "reproduc": 6, "v": [6, 8, 10, 12], "actual": [6, 7, 10], "try": 6, "monarch_statu": 6, "ok": 6, "except": 6, "vllm_version": 6, "contribut": [6, 7, 11], "md": [6, 7], "conduct": [6, 7], "code_of_conduct": [6, 7], "librari": 7, "agent": 7, "develop": 7, "research": 7, "earli": 7, "incomplet": 7, "chang": [7, 12], "pleas": [7, 13], "becom": [7, 10], "frontier": 7, "reason": 7, "often": 7, "domin": 7, "express": 7, "natur": [7, 11, 13], "pseudocod": [7, 10], "while": [7, 8, 10, 11, 12], "underneath": 7, "Not": [7, 11], "logic": [7, 10], "asynchroni": 7, "match": 7, "proven": 7, "framework": [7, 12], "solid": 7, "simplifi": [7, 11], "program": 7, "carefulli": 7, "select": [7, 11], "battl": 7, "d": 7, "machin": 7, "matter": 7, "spmd": 7, "tractabl": 7, "throughput": [7, 10, 11], "scale": [7, 9, 12], "grade": [7, 10], "llm": 7, "solv": [7, 10], "bottleneck": [7, 10, 11, 12], "supervis": [7, 10], "tune": [7, 9], "adapt": 7, "task": 7, "label": 7, "reward": [7, 10, 11], "human": 7, "asynchron": 7, "rollout": [7, 11], "maximum": [7, 12], "safe": [7, 11], "sandbox": 7, "tool": [7, 8], "own": [7, 8, 10, 12], "them": [7, 8], "dive": 7, "def": [7, 8, 10, 11, 12], "generate_episod": 7, "replay_buff": [7, 10, 11], "respons": [7, 10, 11], "reward_valu": 7, "evaluate_respons": [7, 10, 11], "add": [7, 10, 11, 12], "episod": [7, 10, 11], "prompt_id": [7, 10, 11], "response_id": 7, "retri": [7, 10, 11], "just": [7, 8, 10, 12], "prerequisit": 7, "15": [7, 11], "minut": 7, "practic": 7, "hand": 7, "deep": 7, "real": [7, 8, 10, 12], "world": 7, "deploy": 7, "stanford": 7, "collabor": 7, "weaver": 7, "weak": 7, "hill": 7, "climb": 7, "challeng": [7, 11], "benchmark": 7, "math": [7, 11], "gpqa": 7, "coreweav": 7, "512": [7, 10, 11], "h100": 7, "smooth": 7, "hundr": 7, "signific": 7, "signal": 7, "intent": 7, "tracker": 7, "popular": 7, "qwen3": [7, 10, 11, 12], "7b": [7, 10, 11, 12], "quick": [7, 10, 13], "understand": [7, 10, 11, 12, 13], "next": [7, 8, 10, 11, 13], "help": [7, 9, 12], "addit": [7, 11], "theori": [7, 9], "overview": 7, "licens": 7, "bsd": 7, "claus": 7, "aim": 8, "observ": [8, 11], "effortless": 8, "val": 8, "reduce_typ": 8, "tracer": 8, "plug": 8, "plai": 8, "visual": 8, "stream": [8, 10], "boilerpl": 8, "flush": 8, "forge_disable_metr": 8, "simpl": [8, 10, 11, 12], "dictionari": 8, "around": [8, 11], "simpli": 8, "write": [8, 10, 11], "my_fn": 8, "my_metr": 8, "asyncio": [8, 10, 11, 12], "get_or_create_metric_logg": 8, "logger": 8, "mlogger": 8, "process_nam": 8, "init_backend": 8, "call_on": [8, 10, 11, 12], "consol": 8, "logging_mod": 8, "global_reduc": 8, "my_sum_metr": 8, "sum": 8, "my_max_metr": 8, "my_mean_metr": 8, "accumul": 8, "rang": [8, 11], "global_step": 8, "done": [8, 11], "__name__": 8, "__main__": 8, "globalreduc": 8, "6": [8, 10, 12], "durat": 8, "minim": 8, "timer": 8, "kernel": 8, "perf_track": 8, "shown": 8, "randn": 8, "prefix": 8, "my_cuda_loop": 8, "track_memori": 8, "_": 8, "mm": 8, "my_metric_mm": 8, "reset": [8, 11], "memory_delta_end_start_avg_gb": 8, "015": 8, "memory_peak_max_gb": 8, "042": 8, "duration_avg_": 8, "031": 8, "duration_max_": 8, "186": 8, "total_duration_avg_": 8, "094": 8, "total_duration_max_": 8, "187": 8, "conveni": 8, "decor": 8, "trace": 8, "fwd": 8, "x": 8, "bwd": 8, "my_reward_fn": 8, "reward_fn": [8, 11], "both": [8, 11], "els": [8, 11], "chart": 8, "ideal": 8, "view": 8, "per_rank_reduc": 8, "per_rank_no_reduc": 8, "consid": 8, "record": 8, "rank_0": 8, "rank_1": 8, "current_rank": 8, "myactor": [8, 12], "self": [8, 11, 12], "my_sum_rank_metr": 8, "service_config": 8, "my_actor": [8, 12], "fanout": [8, 10, 12], "myactor_661w_r0": 8, "myactor_661w_r1": 8, "myactor_wq1g_r0": 8, "myactor_wq1g_r1": 8, "2025": 8, "21": 8, "09": 8, "do": 8, "bias": 8, "wandb": 8, "loggerbackend": 8, "jsonl": 8, "send": [8, 10, 11, 12], "slack": 8, "notif": 8, "hit": [8, 11], "threshold": 8, "mlflow": 8, "grafana": 8, "regist": 8, "get_logger_backend_class": 8, "consolebackend": 8, "__init__": [8, 11, 12], "logger_backend_config": 8, "super": 8, "init": 8, "log_batch": 8, "int": [8, 11, 12], "log_stream": 8, "wordcounteraccumul": 8, "sampleaccumul": 8, "metriccollector": 8, "meanaccumul": 8, "metricaccumul": 8, "count": 8, "is_reset": 8, "append": 8, "float": [8, 11], "hasattr": 8, "get_valu": [8, 11, 12], "get_stat": 8, "reduction_typ": 8, "get_reduced_value_from_st": 8, "cl": 8, "total_sum": 8, "total_count": 8, "two": [8, 10], "somewher": 8, "address": 8, "singleton": [8, 11], "between": [8, 11], "localfetcheractor": 8, "globalloggingactor": 8, "know": [8, 12], "registr": 8, "occur": 8, "provision": 8, "get_proc_mesh": 8, "flow": 8, "procmesh": 8, "ask": 8, "about": [8, 10, 11], "thei": [8, 11, 12], "live": 8, "place": 8, "mark": 8, "per_rank": 8, "One": [8, 12], "hold": 8, "master": 9, "tutor": 10, "exact": [10, 11], "question": [10, 11], "answer": [10, 11], "qualiti": [10, 11], "give": [10, 11, 13], "prevent": 10, "drift": 10, "replai": 10, "buffer": 10, "experi": [10, 11], "conceptu": [10, 11, 13], "conceptual_rl_step": 10, "student": 10, "teacher": 10, "reward_model": 10, "compute_logprob": 10, "enough": [10, 11], "improv": 10, "curr_policy_vers": [10, 11], "insight": [10, 11], "abov": 10, "again": 10, "would": [10, 11], "conceptual_forge_rl_step": 10, "datasetactor": [10, 11], "rewardactor": [10, 11], "reward_actor": [10, 11], "input_id": [10, 11], "max_req_token": [10, 11], "return_logprob": [10, 11], "ref_logprob": [10, 11], "ref_model": [10, 11], "create_episode_from_respons": 10, "pattern": [10, 12], "auto": 10, "realis": 10, "worri": [10, 11], "infra": 10, "automag": 10, "behind": [10, 11], "scene": [10, 11], "our": [10, 12, 13], "heurist": 10, "massiv": 10, "bank": 10, "intens": 10, "o": 10, "bandwidth": [10, 11], "latenc": [10, 11], "low": 10, "busi": 10, "plu": 10, "failur": [10, 11, 12], "cascad": [10, 12], "halt": 10, "failov": [10, 11], "wast": 10, "naive_rl_step": 10, "idl": 10, "policy_model": 10, "compute_loss": 10, "ineffici": 10, "everyth": 10, "policy_fail": 10, "reward_fail": 10, "trainer_fail": 10, "entire_system_stop": 10, "unit": 10, "easi": 10, "recoveri": [10, 11], "semant": 10, "notic": 10, "cover": 10, "balanc": 10, "real_rl_training_step": 10, "cat": [10, 11], "unsqueez": [10, 11], "tupl": [10, 11], "line": [10, 11], "hidden": 10, "demand": 10, "replaybuff": [10, 11], "rltrainer": [10, 11], "computeadvantag": [10, 11], "mathreward": [10, 11], "thinkingreward": [10, 11], "qwen": [10, 11, 12], "group_siz": 10, "compute_advantag": [10, 11], "openai": [10, 11], "gsm8k": [10, 11], "revis": [10, 11], "data_split": [10, 11], "engine_config": [10, 11], "tensor_parallel_s": [10, 11], "pipeline_parallel_s": [10, 11], "enforce_eag": [10, 11], "sampling_config": [10, 11], "max_token": [10, 11], "16": [10, 11], "temperatur": [10, 11], "top_p": [10, 11], "come": [10, 11, 13], "max_policy_ag": [10, 11], "dp_size": [10, 11], "reward_funct": [10, 11], "intern": [10, 11, 12, 13], "distinct": 10, "explain": [10, 11, 13], "respawn": 10, "background": 10, "impact": [10, 11, 12], "grace": 10, "applic": [10, 12], "monolith": 10, "deeper": [10, 13], "forgeservic": 10, "highli": 11, "concept": [11, 12], "land": 11, "hood": 11, "grab": [11, 13], "chai": [11, 13], "policy_servic": 11, "don": [11, 12], "right": 11, "serviceconfig": 11, "remot": [11, 12], "serial": 11, "serviceactor": [11, 12], "serviceinterfac": 11, "adverb": 11, "normal": 11, "extract": 11, "pick": 11, "characterist": 11, "lowest": 11, "network": 11, "hop": 11, "capac": 11, "critic": 11, "choic": 11, "stateless": 11, "current_vers": 11, "version_replica_1": 11, "version_replica_2": 11, "new_policy_vers": 11, "simultan": 11, "unless": 11, "gotcha": 11, "contact": 11, "arriv": 11, "sleep": 11, "much": 11, "preserv": [11, 12], "sticki": 11, "counter": [11, 12], "demonstr": 11, "forgecount": 11, "initial_valu": [11, 12], "increment": [11, 12], "counter_servic": 11, "goe": [11, 13], "inconsist": 11, "WITH": 11, "nuse": 11, "final_valu": 11, "turn": 11, "response1": 11, "turn1": 11, "full_prompt": 11, "turn2": 11, "response2": 11, "maxim": 11, "ti": 11, "histori": 11, "break": 11, "naive_multi_turn": 11, "miss": 11, "question1": 11, "response3": 11, "conversation_so_far": 11, "optimized_multi_turn": 11, "guarante": 11, "reus": 11, "recomput": 11, "collector": 11, "concurr": 11, "thread": 11, "clarifi": 11, "step_numb": 11, "evict": 11, "old": 11, "state_dict": 11, "safeti": 11, "sequenti": 11, "those": 11, "real_weight_sync": 11, "push": 11, "policy_vers": 11, "simple_rl_step": 11, "field": 11, "action": 11, "episode_id": 11, "pad_id": 11, "pad_token_id": 11, "request_len": 11, "response_len": 11, "request_token": 11, "tolist": 11, "response_token": 11, "dimens": 11, "new_group": 11, "4f": 11, "independ": [11, 12], "model_nam": 11, "fewer": 11, "heavi": 11, "total_reward": 11, "len": 11, "240": 11, "36": 11, "322": 11, "344": 11, "successfulli": 11, "production_training_loop": 11, "create_episode_from_grpo_data": 11, "seri": 12, "peel": [12, 13], "back": [12, 13], "crucial": 12, "abstract": [12, 13], "organ": 12, "think": 12, "dimension": 12, "grid": 12, "topologi": 12, "per_host": 12, "7": 12, "beauti": 12, "seamlessli": 12, "cluster_proc": 12, "spawn_cluster_proc": 12, "host1": 12, "host2": 12, "host3": 12, "stai": 12, "100": 12, "educ": 12, "this_proc": 12, "futur": 12, "fut": 12, "random": 12, "fire": 12, "forget": 12, "rememb": [12, 13], "raw": 12, "policy_actor": 12, "isol": 12, "transpar": 12, "ident": 12, "race": 12, "condit": 12, "lock": 12, "hide": 12, "gracefulli": 12, "fundament": [12, 13], "spawn_servic": 12, "ml": 13, "mention": 13, "welcom": 13, "inspir": 13, "z": 13, "shoutout": 13, "friend": 13, "part": 13, "terminologi": 13, "refresh": 13, "teach": 13, "connect": 13, "101": 13, "talk": 13, "upon": 13, "consum": 13, "roughli": 13, "hour": 13, "enjoi": 13, "eager": 13, "checkout": 13}, "objects": {"forge.actors.generator": [[2, 0, 1, "", "Generator"], [2, 0, 1, "", "GeneratorWorker"]], "forge.actors.generator.Generator": [[2, 1, 1, "", "engine_args"], [2, 1, 1, "", "generate"], [2, 1, 1, "", "get_version"], [2, 1, 1, "", "get_vllm_config"], [2, 1, 1, "", "n_fetcher_procs"], [2, 1, 1, "", "prefetch_weights_to_shm"], [2, 1, 1, "", "register_worker"], [2, 2, 1, "", "run"], [2, 1, 1, "", "sampling_params"], [2, 1, 1, "", "setup"], [2, 2, 1, "", "shutdown"], [2, 1, 1, "", "stop"], [2, 1, 1, "", "update_weights"], [2, 1, 1, "", "use_dcp_for_weight_sync"]], "forge.actors.generator.GeneratorWorker": [[2, 1, 1, "", "execute_model"], [2, 1, 1, "", "setup"], [2, 1, 1, "", "setup_kv_cache"], [2, 1, 1, "", "update_weights"], [2, 1, 1, "", "vllm_config"]], "forge.actors.reference_model": [[3, 0, 1, "", "ReferenceModel"]], "forge.actors.reference_model.ReferenceModel": [[3, 1, 1, "", "checkpoint"], [3, 1, 1, "", "comm"], [3, 1, 1, "", "compile"], [3, 1, 1, "", "forward"], [3, 1, 1, "", "model"], [3, 1, 1, "", "parallelism"], [3, 1, 1, "", "setup"], [3, 1, 1, "", "training"]], "forge.actors.trainer": [[5, 0, 1, "", "RLTrainer"]], "forge.actors.trainer.RLTrainer": [[5, 1, 1, "", "activation_checkpoint"], [5, 1, 1, "", "checkpoint"], [5, 1, 1, "", "cleanup"], [5, 1, 1, "", "comm"], [5, 1, 1, "", "compile"], [5, 1, 1, "", "dcp_path"], [5, 2, 1, "", "forward_backward"], [5, 1, 1, "", "job"], [5, 2, 1, "", "loss"], [5, 1, 1, "", "lr_scheduler"], [5, 1, 1, "", "memory_estimation"], [5, 1, 1, "", "model"], [5, 1, 1, "", "optimizer"], [5, 1, 1, "", "parallelism"], [5, 1, 1, "", "push_weights"], [5, 1, 1, "", "quantize"], [5, 1, 1, "", "setup"], [5, 1, 1, "", "state_dict_key"], [5, 1, 1, "", "train_step"], [5, 1, 1, "", "training"], [5, 1, 1, "", "use_dcp"]], "forge.controller.actor": [[1, 0, 1, "", "ForgeActor"]], "forge.controller.actor.ForgeActor": [[1, 2, 1, "", "as_actor"], [1, 1, 1, "", "hosts"], [1, 2, 1, "", "launch"], [1, 1, 1, "", "mesh_name"], [1, 1, 1, "", "num_replicas"], [1, 2, 1, "", "options"], [1, 1, 1, "", "procs"], [1, 2, 1, "", "shutdown"], [1, 1, 1, "", "with_gpus"]], "forge.controller.service.service": [[4, 0, 1, "", "Service"]], "forge.controller.service.service.Service": [[4, 2, 1, "", "call_all"], [4, 2, 1, "", "get_metrics"], [4, 2, 1, "", "get_metrics_summary"], [4, 2, 1, "", "start_session"], [4, 2, 1, "", "stop"], [4, 2, 1, "", "terminate_session"]], "torchtitan.config.job_config": [[5, 0, 1, "", "Checkpoint"], [5, 0, 1, "", "Job"], [5, 0, 1, "", "Model"], [5, 0, 1, "", "Optimizer"], [5, 0, 1, "", "Parallelism"], [5, 0, 1, "", "Training"]], "torchtitan.config.job_config.Checkpoint": [[5, 1, 1, "", "async_mode"], [5, 1, 1, "", "create_seed_checkpoint"], [5, 1, 1, "", "enable"], [5, 1, 1, "", "enable_first_step_checkpoint"], [5, 1, 1, "", "enable_ft_dataloader_checkpoints"], [5, 1, 1, "", "exclude_from_loading"], [5, 1, 1, "", "export_dtype"], [5, 1, 1, "", "folder"], [5, 1, 1, "", "initial_load_in_hf"], [5, 1, 1, "", "initial_load_in_hf_quantized"], [5, 1, 1, "", "initial_load_model_only"], [5, 1, 1, "", "initial_load_path"], [5, 1, 1, "", "interval"], [5, 1, 1, "", "keep_latest_k"], [5, 1, 1, "", "last_save_in_hf"], [5, 1, 1, "", "last_save_model_only"], [5, 1, 1, "", "load_only"], [5, 1, 1, "", "load_step"]], "torchtitan.config.job_config.Job": [[5, 1, 1, "", "config_file"], [5, 1, 1, "", "custom_config_module"], [5, 1, 1, "", "description"], [5, 1, 1, "", "dump_folder"], [5, 1, 1, "", "print_config"]], "torchtitan.config.job_config.Model": [[5, 1, 1, "", "converters"], [5, 1, 1, "", "flavor"], [5, 1, 1, "", "hf_assets_path"], [5, 1, 1, "", "name"], [5, 1, 1, "", "print_after_conversion"], [5, 1, 1, "", "tokenizer_path"]], "torchtitan.config.job_config.Optimizer": [[5, 1, 1, "", "beta1"], [5, 1, 1, "", "beta2"], [5, 1, 1, "", "early_step_in_backward"], [5, 1, 1, "", "eps"], [5, 1, 1, "", "implementation"], [5, 1, 1, "", "lr"], [5, 1, 1, "", "name"], [5, 1, 1, "", "weight_decay"]], "torchtitan.config.job_config.Parallelism": [[5, 1, 1, "", "context_parallel_degree"], [5, 1, 1, "", "context_parallel_rotate_method"], [5, 1, 1, "", "data_parallel_replicate_degree"], [5, 1, 1, "", "data_parallel_shard_degree"], [5, 1, 1, "", "disable_loss_parallel"], [5, 1, 1, "", "enable_async_tensor_parallel"], [5, 1, 1, "", "enable_compiled_autograd"], [5, 1, 1, "", "expert_parallel_degree"], [5, 1, 1, "", "expert_tensor_parallel_degree"], [5, 1, 1, "", "fsdp_reshard_after_forward"], [5, 1, 1, "", "module_fqns_per_model_part"], [5, 1, 1, "", "pipeline_parallel_degree"], [5, 1, 1, "", "pipeline_parallel_first_stage_less_layers"], [5, 1, 1, "", "pipeline_parallel_last_stage_less_layers"], [5, 1, 1, "", "pipeline_parallel_layers_per_stage"], [5, 1, 1, "", "pipeline_parallel_microbatch_size"], [5, 1, 1, "", "pipeline_parallel_schedule"], [5, 1, 1, "", "pipeline_parallel_schedule_csv"], [5, 1, 1, "", "tensor_parallel_degree"]], "torchtitan.config.job_config.Training": [[5, 1, 1, "", "dataset"], [5, 1, 1, "", "dataset_path"], [5, 1, 1, "", "debug_moe_force_load_balance"], [5, 1, 1, "", "deterministic"], [5, 1, 1, "", "dtype"], [5, 1, 1, "", "enable_cpu_offload"], [5, 1, 1, "", "gc_debug"], [5, 1, 1, "", "gc_freq"], [5, 1, 1, "", "global_batch_size"], [5, 1, 1, "", "local_batch_size"], [5, 1, 1, "", "max_norm"], [5, 1, 1, "", "mixed_precision_param"], [5, 1, 1, "", "mixed_precision_reduce"], [5, 1, 1, "", "seed"], [5, 1, 1, "", "seq_len"], [5, 1, 1, "", "steps"]]}, "objtypes": {"0": "py:class", "1": "py:attribute", "2": "py:method"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "attribute", "Python attribute"], "2": ["py", "method", "Python method"]}, "titleterms": {"api": 0, "refer": [0, 11], "overview": 0, "forgeactor": 1, "gener": 2, "generatorwork": 2, "model": [3, 5], "referencemodel": 3, "servic": [4, 10, 11, 12], "trainer": 5, "rltrainer": 5, "configur": [5, 6, 11], "job": 5, "optim": 5, "train": [5, 6, 11], "parallel": 5, "checkpoint": 5, "get": 6, "start": 6, "system": 6, "requir": [6, 7], "prerequisit": 6, "instal": 6, "verifi": 6, "your": [6, 8, 12], "setup": 6, "quick": [6, 11], "exampl": [6, 10, 11], "1": [6, 8, 10, 11], "supervis": 6, "fine": 6, "tune": 6, "sft": 6, "2": [6, 8, 10, 11], "grpo": 6, "understand": 6, "file": 6, "next": 6, "step": [6, 10], "help": 6, "addit": 6, "resourc": [6, 10], "torchforg": [7, 10, 11, 12, 13], "document": 7, "why": [7, 10, 12], "core": [7, 10], "design": 7, "principl": 7, "foundat": [7, 12], "The": [7, 10, 11, 12], "technologi": 7, "stack": 7, "what": [7, 10, 11, 12], "you": [7, 12], "can": 7, "build": 7, "glanc": 7, "write": 7, "rl": [7, 10, 13], "code": [7, 12], "path": 7, "valid": 7, "partnership": 7, "commun": [7, 11], "indic": 7, "metric": 8, "log": 8, "forg": 8, "superpow": 8, "call": [8, 12], "record_metr": 8, "from": [8, 10, 13], "anywher": 8, "track": 8, "perform": 8, "time": 8, "memori": 8, "mode": 8, "3": [8, 10, 11, 12], "us": [8, 10, 12], "multipl": [8, 12], "backend": 8, "ad": 8, "new": 8, "4": 8, "reduc": 8, "type": 8, "5": 8, "behind": 8, "scene": 8, "tutori": [9, 13], "part": [10, 11, 12], "fundament": 10, "terminologi": 10, "compon": [10, 11], "toi": 10, "teach": 10, "math": 10, "defin": 10, "name": 10, "learn": [10, 12], "flow": 10, "concept": 10, "thi": [10, 12], "matter": [10, 12], "tradit": 10, "ml": 10, "infrastructur": [10, 12], "fail": 10, "challeng": 10, "problem": [10, 11], "differ": 10, "need": 10, "complex": 10, "interdepend": 10, "coordin": [10, 11], "enter": 10, "nativ": 10, "architectur": [10, 12], "make": 10, "power": 10, "automat": 10, "manag": [10, 11], "independ": 10, "scale": [10, 11, 13], "fault": 10, "toler": 10, "peel": 11, "back": 11, "abstract": 11, "ar": 11, "anatomi": 11, "beyond": 11, "interfac": 11, "deep": [11, 12], "dive": [11, 12], "real": 11, "creation": [11, 12], "how": [11, 12], "actual": 11, "work": 11, "pattern": 11, "rout": 11, "load": 11, "balanc": 11, "singl": [11, 12], "replica": 11, "fanout": 11, "broadcast": 11, "result": 11, "collect": 11, "stream": 11, "oper": 11, "custom": 11, "implement": [11, 13], "session": 11, "state": 11, "realiti": 11, "kv": 11, "cach": 11, "replai": 11, "buffer": 11, "consist": 11, "weight": 11, "synchron": 11, "strategi": 11, "asynchron": 11, "approach": 11, "let": 11, "handl": 11, "speed": 11, "mismatch": 11, "orchestr": 11, "loop": 11, "monarch": 12, "connect": 12, "complet": 12, "hierarchi": 12, "silicon": 12, "procmesh": 12, "host": 12, "multi": 12, "actor": 12, "mesh": 12, "run": 12, "distribut": 12, "process": 12, "execut": 12, "share": 12, "kei": 12, "insight": 12, "conclus": 12, "ve": 12, "takeawai": 12, "zero": 13, "theori": 13, "product": 13, "structur": 13}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx_last_updated_by_git": 1, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 60}, "alltitles": {"API Reference": [[0, "api-reference"]], "Overview": [[0, "overview"]], "ForgeActor": [[1, "forgeactor"]], "Generator": [[2, "generator"], [2, "id1"]], "GeneratorWorker": [[2, "generatorworker"]], "Model": [[3, "model"]], "ReferenceModel": [[3, "referencemodel"]], "Service": [[4, "service"]], "Trainer": [[5, "trainer"]], "RLTrainer": [[5, "rltrainer"]], "Configuration": [[5, "configuration"]], "Job Configuration": [[5, "job-configuration"]], "Model Configuration": [[5, "model-configuration"]], "Optimizer Configuration": [[5, "optimizer-configuration"]], "Training Configuration": [[5, "training-configuration"]], "Parallelism Configuration": [[5, "parallelism-configuration"]], "Checkpoint Configuration": [[5, "checkpoint-configuration"]], "Getting Started": [[6, "getting-started"]], "System Requirements": [[6, "system-requirements"]], "Prerequisites": [[6, "prerequisites"]], "Installation": [[6, "installation"]], "Verifying Your Setup": [[6, "verifying-your-setup"]], "Quick Start Examples": [[6, "quick-start-examples"]], "Example 1: Supervised Fine-Tuning (SFT)": [[6, "example-1-supervised-fine-tuning-sft"]], "Example 2: GRPO Training": [[6, "example-2-grpo-training"]], "Understanding Configuration Files": [[6, "understanding-configuration-files"]], "Next Steps": [[6, "next-steps"]], "Getting Help": [[6, "getting-help"]], "Additional Resources": [[6, "additional-resources"]], "TorchForge Documentation": [[7, "torchforge-documentation"]], "Why TorchForge?": [[7, "why-torchforge"]], "Core Design Principles": [[7, "core-design-principles"]], "Foundation: The Technology Stack": [[7, "foundation-the-technology-stack"]], "What You Can Build": [[7, "what-you-can-build"]], "Requirements at a Glance": [[7, "requirements-at-a-glance"]], "Writing RL Code": [[7, "writing-rl-code"]], "Documentation Paths": [[7, "documentation-paths"]], "Validation & Partnerships": [[7, "validation-partnerships"]], "Community": [[7, "community"]], "Documentation": [[7, null]], "Indices": [[7, "indices"]], "Metric Logging in Forge": [[8, "metric-logging-in-forge"]], "1. Your Superpowers": [[8, "your-superpowers"]], "1.1 Call record_metric from Anywhere": [[8, "call-record-metric-from-anywhere"]], "1.2 Track Performance: Timing and Memory": [[8, "track-performance-timing-and-memory"]], "2. Logging Modes": [[8, "logging-modes"]], "3. Using Multiple Backends": [[8, "using-multiple-backends"]], "3.1 Adding a New Backend": [[8, "adding-a-new-backend"]], "4. Adding a New Reduce Type": [[8, "adding-a-new-reduce-type"]], "5. Behind the Scenes": [[8, "behind-the-scenes"]], "Tutorials": [[9, "tutorials"]], "Part 1: RL Fundamentals - Using TorchForge Terminology": [[10, "part-1-rl-fundamentals-using-torchforge-terminology"]], "Core RL Components in TorchForge": [[10, "core-rl-components-in-torchforge"]], "The Toy Example: Teaching Math": [[10, "the-toy-example-teaching-math"]], "RL Components Defined (TorchForge Names)": [[10, "rl-components-defined-torchforge-names"]], "The RL Learning Flow": [[10, "the-rl-learning-flow"]], "From Concepts to TorchForge Services": [[10, "from-concepts-to-torchforge-services"]], "RL Step with TorchForge Services": [[10, "rl-step-with-torchforge-services"]], "Why This Matters: Traditional ML Infrastructure Fails": [[10, "why-this-matters-traditional-ml-infrastructure-fails"]], "The Infrastructure Challenge": [[10, "the-infrastructure-challenge"]], "Problem 1: Different Resource Needs": [[10, "problem-1-different-resource-needs"]], "Problem 2: Complex Interdependencies": [[10, "problem-2-complex-interdependencies"]], "Problem 3: The Coordination Challenge": [[10, "problem-3-the-coordination-challenge"]], "Enter TorchForge: RL-Native Architecture": [[10, "enter-torchforge-rl-native-architecture"]], "What Makes This Powerful": [[10, "what-makes-this-powerful"]], "Automatic Resource Management": [[10, "automatic-resource-management"]], "Independent Scaling": [[10, "independent-scaling"]], "Fault Tolerance": [[10, "fault-tolerance"]], "Part 2: Peeling Back the Abstraction - What Are Services?": [[11, "part-2-peeling-back-the-abstraction-what-are-services"]], "Service Anatomy: Beyond the Interface": [[11, "service-anatomy-beyond-the-interface"]], "Service Components Deep Dive": [[11, "service-components-deep-dive"]], "1. Real Service Configuration": [[11, "real-service-configuration"]], "2. Real Service Creation": [[11, "real-service-creation"]], "3. How Services Actually Work": [[11, "how-services-actually-work"]], "Communication Patterns: Quick Reference": [[11, "communication-patterns-quick-reference"]], "Deep Dive: Service Communication Patterns": [[11, "deep-dive-service-communication-patterns"]], "1. .route() - Load Balanced Single Replica": [[11, "route-load-balanced-single-replica"]], "2. .fanout() - Broadcast with Results Collection": [[11, "fanout-broadcast-with-results-collection"]], "3. Streaming Operations - Custom Implementation Pattern": [[11, "streaming-operations-custom-implementation-pattern"]], "3. Service Sessions for Stateful Operations": [[11, "service-sessions-for-stateful-operations"]], "Deep Dive: State Management Reality": [[11, "deep-dive-state-management-reality"]], "The KV Cache Problem": [[11, "the-kv-cache-problem"]], "Replay Buffer Consistency": [[11, "replay-buffer-consistency"]], "Weight Synchronization Strategy": [[11, "weight-synchronization-strategy"]], "Deep Dive: Asynchronous Coordination Patterns": [[11, "deep-dive-asynchronous-coordination-patterns"]], "The TorchForge Approach: Let Services Handle Coordination": [[11, "the-torchforge-approach-let-services-handle-coordination"]], "Handling Speed Mismatches with Service Scaling": [[11, "handling-speed-mismatches-with-service-scaling"]], "Service Implementation Example": [[11, "service-implementation-example"]], "Service Orchestration: The Training Loop": [[11, "service-orchestration-the-training-loop"]], "Part 3: The TorchForge-Monarch Connection": [[12, "part-3-the-torchforge-monarch-connection"]], "The Complete Hierarchy: Service to Silicon": [[12, "the-complete-hierarchy-service-to-silicon"]], "Deep Dive: ProcMesh - The Foundation": [[12, "deep-dive-procmesh-the-foundation"]], "Single Host ProcMesh": [[12, "single-host-procmesh"]], "Multi-Host ProcMesh": [[12, "multi-host-procmesh"]], "Actor Meshes: Your Code Running Distributed": [[12, "actor-meshes-your-code-running-distributed"]], "How TorchForge Services Use Monarch": [[12, "how-torchforge-services-use-monarch"]], "The Service Creation Process": [[12, "the-service-creation-process"]], "Service Call to Actor Execution": [[12, "service-call-to-actor-execution"]], "Multiple Services Sharing Infrastructure": [[12, "multiple-services-sharing-infrastructure"]], "Key Insights: Why This Architecture Matters": [[12, "key-insights-why-this-architecture-matters"]], "Conclusion": [[12, "conclusion"]], "What You\u2019ve Learned": [[12, "what-you-ve-learned"]], "Key Takeaways": [[12, "key-takeaways"]], "Zero to TorchForge: From RL Theory to Production-Scale Implementation": [[13, "zero-to-torchforge-from-rl-theory-to-production-scale-implementation"]], "Tutorial Structure": [[13, "tutorial-structure"]]}, "indexentries": {"forgeactor (class in forge.controller.actor)": [[1, "forge.controller.actor.ForgeActor"]], "as_actor() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.as_actor"]], "hosts (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.hosts"]], "launch() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.launch"]], "mesh_name (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.mesh_name"]], "num_replicas (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.num_replicas"]], "options() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.options"]], "procs (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.procs"]], "shutdown() (forge.controller.actor.forgeactor class method)": [[1, "forge.controller.actor.ForgeActor.shutdown"]], "with_gpus (forge.controller.actor.forgeactor attribute)": [[1, "forge.controller.actor.ForgeActor.with_gpus"]], "generator (class in forge.actors.generator)": [[2, "forge.actors.generator.Generator"]], "generatorworker (class in forge.actors.generator)": [[2, "forge.actors.generator.GeneratorWorker"]], "engine_args (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.engine_args"]], "execute_model (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.execute_model"]], "generate (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.generate"]], "get_version (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.get_version"]], "get_vllm_config (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.get_vllm_config"]], "n_fetcher_procs (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.n_fetcher_procs"]], "prefetch_weights_to_shm (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.prefetch_weights_to_shm"]], "register_worker (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.register_worker"]], "run() (forge.actors.generator.generator method)": [[2, "forge.actors.generator.Generator.run"]], "sampling_params (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.sampling_params"]], "setup (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.setup"]], "setup (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.setup"]], "setup_kv_cache (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.setup_kv_cache"]], "shutdown() (forge.actors.generator.generator class method)": [[2, "forge.actors.generator.Generator.shutdown"]], "stop (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.stop"]], "update_weights (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.update_weights"]], "update_weights (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.update_weights"]], "use_dcp_for_weight_sync (forge.actors.generator.generator attribute)": [[2, "forge.actors.generator.Generator.use_dcp_for_weight_sync"]], "vllm_config (forge.actors.generator.generatorworker attribute)": [[2, "forge.actors.generator.GeneratorWorker.vllm_config"]], "referencemodel (class in forge.actors.reference_model)": [[3, "forge.actors.reference_model.ReferenceModel"]], "checkpoint (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.checkpoint"]], "comm (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.comm"]], "compile (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.compile"]], "forward (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.forward"]], "model (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.model"]], "parallelism (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.parallelism"]], "setup (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.setup"]], "training (forge.actors.reference_model.referencemodel attribute)": [[3, "forge.actors.reference_model.ReferenceModel.training"]], "service (class in forge.controller.service.service)": [[4, "forge.controller.service.service.Service"]], "call_all() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.call_all"]], "get_metrics() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.get_metrics"]], "get_metrics_summary() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.get_metrics_summary"]], "start_session() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.start_session"]], "stop() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.stop"]], "terminate_session() (forge.controller.service.service.service method)": [[4, "forge.controller.service.service.Service.terminate_session"]], "checkpoint (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Checkpoint"]], "job (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Job"]], "model (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Model"]], "optimizer (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Optimizer"]], "parallelism (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Parallelism"]], "rltrainer (class in forge.actors.trainer)": [[5, "forge.actors.trainer.RLTrainer"]], "training (class in torchtitan.config.job_config)": [[5, "torchtitan.config.job_config.Training"]], "activation_checkpoint (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.activation_checkpoint"]], "async_mode (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.async_mode"]], "beta1 (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.beta1"]], "beta2 (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.beta2"]], "checkpoint (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.checkpoint"]], "cleanup (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.cleanup"]], "comm (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.comm"]], "compile (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.compile"]], "config_file (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.config_file"]], "context_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.context_parallel_degree"]], "context_parallel_rotate_method (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.context_parallel_rotate_method"]], "converters (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.converters"]], "create_seed_checkpoint (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.create_seed_checkpoint"]], "custom_config_module (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.custom_config_module"]], "data_parallel_replicate_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.data_parallel_replicate_degree"]], "data_parallel_shard_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.data_parallel_shard_degree"]], "dataset (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dataset"]], "dataset_path (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dataset_path"]], "dcp_path (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.dcp_path"]], "debug_moe_force_load_balance (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.debug_moe_force_load_balance"]], "description (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.description"]], "deterministic (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.deterministic"]], "disable_loss_parallel (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.disable_loss_parallel"]], "dtype (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.dtype"]], "dump_folder (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.dump_folder"]], "early_step_in_backward (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.early_step_in_backward"]], "enable (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable"]], "enable_async_tensor_parallel (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.enable_async_tensor_parallel"]], "enable_compiled_autograd (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.enable_compiled_autograd"]], "enable_cpu_offload (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.enable_cpu_offload"]], "enable_first_step_checkpoint (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable_first_step_checkpoint"]], "enable_ft_dataloader_checkpoints (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.enable_ft_dataloader_checkpoints"]], "eps (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.eps"]], "exclude_from_loading (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.exclude_from_loading"]], "expert_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.expert_parallel_degree"]], "expert_tensor_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.expert_tensor_parallel_degree"]], "export_dtype (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.export_dtype"]], "flavor (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.flavor"]], "folder (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.folder"]], "forward_backward() (forge.actors.trainer.rltrainer method)": [[5, "forge.actors.trainer.RLTrainer.forward_backward"]], "fsdp_reshard_after_forward (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.fsdp_reshard_after_forward"]], "gc_debug (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.gc_debug"]], "gc_freq (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.gc_freq"]], "global_batch_size (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.global_batch_size"]], "hf_assets_path (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.hf_assets_path"]], "implementation (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.implementation"]], "initial_load_in_hf (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_in_hf"]], "initial_load_in_hf_quantized (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_in_hf_quantized"]], "initial_load_model_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_model_only"]], "initial_load_path (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.initial_load_path"]], "interval (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.interval"]], "job (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.job"]], "keep_latest_k (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.keep_latest_k"]], "last_save_in_hf (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.last_save_in_hf"]], "last_save_model_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.last_save_model_only"]], "load_only (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.load_only"]], "load_step (torchtitan.config.job_config.checkpoint attribute)": [[5, "torchtitan.config.job_config.Checkpoint.load_step"]], "local_batch_size (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.local_batch_size"]], "loss() (forge.actors.trainer.rltrainer method)": [[5, "forge.actors.trainer.RLTrainer.loss"]], "lr (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.lr"]], "lr_scheduler (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.lr_scheduler"]], "max_norm (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.max_norm"]], "memory_estimation (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.memory_estimation"]], "mixed_precision_param (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.mixed_precision_param"]], "mixed_precision_reduce (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.mixed_precision_reduce"]], "model (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.model"]], "module_fqns_per_model_part (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.module_fqns_per_model_part"]], "name (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.name"]], "name (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.name"]], "optimizer (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.optimizer"]], "parallelism (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.parallelism"]], "pipeline_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_degree"]], "pipeline_parallel_first_stage_less_layers (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_first_stage_less_layers"]], "pipeline_parallel_last_stage_less_layers (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_last_stage_less_layers"]], "pipeline_parallel_layers_per_stage (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_layers_per_stage"]], "pipeline_parallel_microbatch_size (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_microbatch_size"]], "pipeline_parallel_schedule (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_schedule"]], "pipeline_parallel_schedule_csv (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.pipeline_parallel_schedule_csv"]], "print_after_conversion (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.print_after_conversion"]], "print_config (torchtitan.config.job_config.job attribute)": [[5, "torchtitan.config.job_config.Job.print_config"]], "push_weights (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.push_weights"]], "quantize (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.quantize"]], "seed (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.seed"]], "seq_len (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.seq_len"]], "setup (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.setup"]], "state_dict_key (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.state_dict_key"]], "steps (torchtitan.config.job_config.training attribute)": [[5, "torchtitan.config.job_config.Training.steps"]], "tensor_parallel_degree (torchtitan.config.job_config.parallelism attribute)": [[5, "torchtitan.config.job_config.Parallelism.tensor_parallel_degree"]], "tokenizer_path (torchtitan.config.job_config.model attribute)": [[5, "torchtitan.config.job_config.Model.tokenizer_path"]], "train_step (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.train_step"]], "training (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.training"]], "use_dcp (forge.actors.trainer.rltrainer attribute)": [[5, "forge.actors.trainer.RLTrainer.use_dcp"]], "weight_decay (torchtitan.config.job_config.optimizer attribute)": [[5, "torchtitan.config.job_config.Optimizer.weight_decay"]]}})